# med-processor
Set of CLI tools used for a medical research. It includes the following tools:
* med-parser
* blinder
* formatter

Each tool performs a certain operation on source files producing output required for the following research step.  
These tools are usually run sequentially in the above order making a pipeline as a whole.

## Build and run
Build project and create executable artifacts with the command:
```bash
./mvnw package
```

See run instructions for each tool below.

### med-parser
Med-parser tool is responsible for extracting pubmed publications from a source dataset. It runs the following steps:
* parse publications from a source dataset file
* split publications into groups by checking against predicates
* save publications from each group to a file system 
* (optional) shuffle publications within each group, perform partitioning by chunks of fixed size, save to file system

In order to run parser, you need to construct configuration file, for example:

```
inputFileName: './data/pubmed_result-ALL-countries-short.txt'
outputDir: './out'
partitionSize: 50
partitionNumber: 0

countries:
  russia:
      keywords: ['Russia', 'Russian Federation']
      predicate: FIRST_AFFILIATION
  japan:
      keywords: ['Japan']
      predicate: FIRST_AFFILIATION
  china:
      keywords: ['China']
      predicate: FIRST_AFFILIATION
  taiwan:
      keywords: ['Taiwan']
      predicate: FIRST_AFFILIATION
  uk:
      keywords: ['UK', 'United Kingdom', 'England']
      predicate: FIRST_AFFILIATION
```

Run med-parser passing in a path to the above config file:  
`java -Xmx2g -jar med-parser-1.0.jar --config=./config.yml | tee log.txt`

### blinder
This tool removes any unnecessary information from publication description thus leaving only essential part of description.   
Run blinder tool and pass in a path to a file consisting of publication descriptions:  
`java -jar blinder.jar russia_out_matched_shuffled_58.txt`

### formatter
The last step is to produce CSV from files generated by the blinder tool.
Run formatter tool and pass in a path to a file with "blinded" publications:  
`java -jar formatter.jar russia_out_matched_shuffled_58_blinded.txt`  
This example will produce `russia_out_matched_shuffled_58_blinded.csv` which is required for following research steps.
